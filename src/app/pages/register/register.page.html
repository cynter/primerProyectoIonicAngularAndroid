<ion-content class="ion-padding">
  <div class="center-container">
    <div class="max-w-md mx-auto">
      <h1 class="title">Registro</h1>
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <ion-list lines="full">
          <ion-item>
            <ion-label position="stacked">Correo</ion-label>
            <ion-input type="email" formControlName="email" autocomplete="email" ngDefaultControl></ion-input>
          </ion-item>
          <ion-text color="danger" *ngIf="showError('email','required')">El correo es requerido</ion-text>
          <ion-text color="danger" *ngIf="showError('email','email')">Correo inválido</ion-text>

          <ion-item class="ion-margin-top">
            <ion-label position="stacked">Clave</ion-label>
            <ion-input [type]="showPassword ? 'text' : 'password'" formControlName="password"
              autocomplete="new-password" ngDefaultControl></ion-input>
            <ion-icon slot="end" [name]="showPassword ? 'eye-off' : 'eye'" (click)="togglePassword()"
              style="cursor:pointer"></ion-icon>
          </ion-item>
          <ion-text color="danger" *ngIf="showError('password','required')">La clave es requerida</ion-text>
          <ion-text color="danger" *ngIf="showError('password','minlength')">Mínimo 6 caracteres</ion-text>

          <ion-item class="ion-margin-top">
            <ion-label position="stacked">Repetir clave</ion-label>
            <ion-input [type]="showPassword2 ? 'text' : 'password'" formControlName="password2"
              autocomplete="new-password" ngDefaultControl></ion-input>
            <ion-icon slot="end" [name]="showPassword2 ? 'eye-off' : 'eye'" (click)="togglePassword2()"
              style="cursor:pointer"></ion-icon>
          </ion-item>
          <ion-text color="danger" *ngIf="showError('password2','required')">Debe repetir la clave</ion-text>
          <ion-text color="danger" *ngIf="showFormError('passwordMismatch')">Las claves no coinciden</ion-text>
        </ion-list>

        <ion-button expand="block" class="ion-margin-top" type="submit" [disabled]="form.invalid || loading()">
          <ng-container *ngIf="!loading(); else cargando">
            Registrarse
          </ng-container>
          <ng-template #cargando>
            <ion-spinner></ion-spinner>
          </ng-template>
        </ion-button>
      </form>

      <ion-text color="danger" *ngIf="errorMsg() as err" class="ion-margin-top block">{{ err }}</ion-text>

    </div>
  </div>
</ion-content>